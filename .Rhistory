###BL5323 Final Project###
#Please remember to change the working directory when running on your laptop.
###library
library(rgdal)
library(sp)
library(sf)
library(terra)
#set the working directory
setwd("/Users/zhangfengqi/Desktop/NUS/BL5323/FinalProject/BL5323")
#input the country boundary file
Country = vect("./DataMap//WorldCountries/WorldCountriesWithISO.shp")
VNM = Country[Country$ISO3 == "VNM",]
###Soil carbon map
SoC = rast("./DataMap/GSOCmap1.6.1.tif")
SoC = project(SoC, crs(Country))
SoC_VNM = crop(SoC, VNM, mask = T)
plot(SoC_VNM, main = "Soil Carbon (VNM)")
###Comparison between two versions of aboveground biomass map
AbGBio_VNM = rast("./DataMap/AbGBio_VNM.tif")
BGBio_VNM = rast("./DataMap/BGBio_VNM.tif")
AbGBio_VNM
BGBio_VNM
BGBio_VNM
SoC_VNM
?resample
#resample
AbGBio_VNM = resample(AbGBio_VNM, SoC_VNM, method = 'bilinear')
BGBio_VNM = resample(BGBio_VNM, SoC_VNM, method = 'bilinear')
writeRaster(AbGBio_VNM, "./DataMap/AbGBio_VNM_30s.tif")
writeRaster(BGBio_VNM, "./DataMap/BGBio_VNM_30s.tif")
par(mfrow = c(1,3))
plot(AbGBio_VNM, main = "AbG (VNM)")
plot(BGBio_VNM, main = "BG (VNM)")
plot(SoC_VNM, main = "SoC (VNM)")
#Sum of Biomass
Bio_VNM = AbGBio_VNM + BGBio_VNM
CO2_VNM = Bio_VNM*0.49*(44/12) + SoC_VNM*0.25*(44/12) + 2.1*(44/12)
plot(CO2_VNM, main = "Potential CO2 Emissions (VNM)")
plot(CO2_VNM, main = "Potential CO2 Emissions (VNM)")
PA_VNM = vect("./DataMap/WDPA_WDOECM_Mar2023_Public_VNM_shp/WDPA_WDOECM_Mar2023_Public_VNM_shp_2/WDPA_WDOECM_Mar2023_Public_VNM_shp-polygons.shp")
PA_VNM = project(PA_VNM, crs(Country))
plot(VNM)
plot(PA_VNM, add = T, col = 'green', main = "WDPA (VNM)")
plot(VNM, main = "WDPA (VNM)")
plot(PA_VNM, add = T, col = 'green')
PA_VNM
?crop
?mask
?crop
deForRisk_VNM = rast("./DataMap/deForRisk_VNM.tif")
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.5)
deForRisk_VNM
CO2_VNM
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.5)
deForRisk_VNM = project(deForRisk_VNM, crs(Country))
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.5)
deForRisk_VNM = resample(deForRisk_VNM, CO2_VNM, method = 'bilinear')
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.5)
plot(CO2_VNM_deFor)
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.6)
plot(CO2_VNM_deFor)
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.4)
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.4)
plot(CO2_VNM_deFor, main = "Additional Carbon (40%)")
CO2_VNM_deFor = CO2_VNM*(deForRisk_VNM > 0.3)
plot(CO2_VNM_deFor, main = "Additional Carbon (30%)")
CO2_VNM_deFor_3 = CO2_VNM*(deForRisk_VNM > 0.3)
CO2_VNM_deFor_4 = CO2_VNM*(deForRisk_VNM > 0.4)
CO2_VNM_deFor_5 = CO2_VNM*(deForRisk_VNM > 0.5)
par(mfrow = c(1, 3))
plot(CO2_VNM_deFor_3, main = "Additional Carbon (30%)")
plot(CO2_VNM_deFor_4, main = "Additional Carbon (40%)")
plot(CO2_VNM_deFor_5, main = "Additional Carbon (50%)")
?plot
par(mfrow = c(1, 3))
plot(CO2_VNM_deFor_3, main = "Additional Carbon (30%)")
plot(PA_VNM, col = 'grey', alpha = 0.5)
plot(CO2_VNM_deFor_4, main = "Additional Carbon (40%)")
plot(PA_VNM, col = 'grey', alpha = 0.5)
plot(CO2_VNM_deFor_5, main = "Additional Carbon (50%)")
plot(PA_VNM, col = 'grey', alpha = 0.5)
par(mfrow = c(1, 3))
plot(CO2_VNM_deFor_3, main = "Additional Carbon (30%)")
plot(PA_VNM, col = 'grey', alpha = 0.5, add = T)
plot(CO2_VNM_deFor_4, main = "Additional Carbon (40%)")
plot(PA_VNM, col = 'grey', alpha = 0.5, add = T)
plot(CO2_VNM_deFor_5, main = "Additional Carbon (50%)")
plot(PA_VNM, col = 'grey', alpha = 0.5, add = T)
?expanse
###the cost
AgriRent = rast("./DataMap/Rent2016Com.tif")
AgriRent = project(AgriRent, crs(Country))
AgriRent_VNM = crop(AgriRent, VNM, mask = T)
AgriRent_VNM
Area_VNM_5 = expanse(CO2_VNM_deFor_5, unit = 'ha')
Area_VNM_5
Area_VNM_5 = expanse(CO2_VNM_deFor_5, unit = 'km')
Area_VNM_5 = expanse(CO2_VNM_deFor_5, unit = 'km')
Area_VNM_5
Area_VNM_3 = expanse(CO2_VNM_deFor_3, unit = 'ha')
Area_VNM_4 = expanse(CO2_VNM_deFor_4, unit = 'ha')
Area_VNM_5 = expanse(CO2_VNM_deFor_5, unit = 'ha')
Area_VNM_3
Area_VNM_4
Area_VNM_5
#revenue
CO2_VNM_3 = (CO2_VNM_deFor_3 == 0)*NA
plot(CO2_VNM_3)
#revenue
CO2_VNM_3 = (CO2_VNM_deFor_3 != 0)*CO2_VNM_deFor_3
plot(CO2_VNM_3)
is.na(CO2_VNM_3)
Area_VNM_3 = expanse(CO2_VNM_deFor_3, unit = 'ha')
Area_VNM_3
#revenue (euro dollar)
CCredit = CO2_VNM_deFor_5*100
plot(CCredit)
plot(CCredit, main = "Carbon Credit per hectare")
###the cost
AgriRent = rast("./DataMap/Rent2016Com.tif")
AgriRent = project(AgriRent, crs(Country))
AgriRent_VNM = crop(AgriRent, VNM, mask = T)
plot(AgriRent_VNM, main = "Agricultural Rents (VNM)")
plot(AgriRent_VNM, main = "Agricultural Rents (VNM, USD)")
#revenue (euro dollar)
CCredit = CO2_VNM_deFor_5*100*1.066
plot(CCredit, main = "Carbon Credit per hectare (USD)")
